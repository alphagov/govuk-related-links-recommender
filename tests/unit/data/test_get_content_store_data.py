import pytest

import json
import pandas.testing as pd_testing

from src.data.get_content_store_data import *


# TODO: look into using this plugin instead and creating our own fixtures, with a module scope instead of function
@pytest.mark.filterwarnings(
    "ignore:insert is deprecated. Use insert_one or insert_many instead.:DeprecationWarning")
@pytest.mark.filterwarnings(
    "ignore:collection_names is deprecated. Use list_collection_names instead.:UserWarning")
def test_get_related_links(mongodb):
    assert sorted(json.loads(json.dumps(get_related_links(mongodb.content_store_data_sample))), key=lambda k: k['_id']) == sorted(
        [
            {'_id': '/getting-parole',
             'expanded_links': {'ordered_related_items': [
                 {'base_path': '/leaving-prison',
                  'content_id': '2d9a07a8-fe56-44a7-929c-18808df1c746'},
                 {'base_path': '/guide-to-probation',
                  'content_id': '6b69904c-049f-4115-97cb-c5c8b72a58e0'},
                 {'base_path': '/apply-for-parole-if-youre-a-young-offender',
                  'content_id': '3c2c3f17-db07-47cc-8cf9-ecdd736e5096'},
                 {'base_path': '/your-rights-after-crime',
                  'content_id': 'a443f6bd-e005-4003-986f-517e37e63b56'},
                 {'base_path': '/get-support-as-a-victim-of-crime',
                  'content_id': '3bcc1c74-b7e9-4ce8-878d-d79a1f8ec562'},
                 {'base_path': '/make-a-statement-to-the-parole-board',
                  'content_id': 'adf459af-62c2-45f7-9427-9fcf56d900fc'}]},
             'content_id': '193343fa-0edb-45d9-919f-9a4087c32910'},
            {'_id': '/expenses-benefits-sporting-recreational-facilities',
             'expanded_links': {'ordered_related_items': [{'base_path': '/employer-reporting-expenses-benefits',
                                                           'content_id': '6d40aebf-c225-4d3c-a751-fa8f543e27b8'},
                                                          {'base_path': '/running-payroll',
                                                           'content_id': '88309f75-af24-42e9-b30d-e36157cf918b'}]},
             'content_id': '4e277dc9-faeb-41cc-b76e-2dc7cb0b6e2f'}], key=lambda k: k['_id'])


@pytest.mark.filterwarnings(
    "ignore:insert is deprecated. Use insert_one or insert_many instead.:DeprecationWarning")
@pytest.mark.filterwarnings(
    "ignore:collection_names is deprecated. Use list_collection_names instead.:UserWarning")
def test_get_collection_links(mongodb):
    assert sorted(get_collection_links(mongodb.content_store_data_sample), key=lambda k: k['_id']) == sorted(
        [
        {'_id': '/government/collections/school-improvement-support',
          'expanded_links': {'documents': [{'base_path': '/guidance/find-volunteers-to-become-school-governors-and-trustees',
             'content_id': 'b32091f6-15d0-4331-944c-7553c21c7f9a'},
            {'base_path': '/guidance/get-support-to-build-and-sustain-your-leadership-team',
             'content_id': '166098ba-c29b-4718-97cc-eb517e35660c'},
            {'base_path': '/guidance/system-leaders-who-they-are-and-what-they-do',
             'content_id': '5f16471b-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/guidance/get-help-to-improve-teaching-retention-and-career-progression',
             'content_id': 'b8d260fb-9727-4506-9197-b85e37e11d05'},
            {'base_path': '/guidance/make-effective-use-of-heritage-resources-to-teach-local-history',
             'content_id': '17659b87-07ab-4a1c-97ad-1f7c9b6e81d7'},
            {'base_path': '/guidance/join-the-mandarin-excellence-programme',
             'content_id': '1e671d2a-b3d7-44f7-bfd9-ef609e36ebcf'},
            {'base_path': '/guidance/get-support-from-your-local-english-education-hub',
             'content_id': 'beab597b-7886-4e53-98a0-7b84804d5cff'},
            {'base_path': '/guidance/get-support-from-your-local-maths-hub',
             'content_id': '6f6b56a1-1294-46f6-ab67-734382e0bca0'},
            {'base_path': '/guidance/get-support-from-your-music-education-hub',
             'content_id': 'c20e1f70-bf93-41bb-8ceb-153235b5856f'},
            {'base_path': '/guidance/work-with-local-partners-to-develop-science-teaching-in-your-school',
             'content_id': 'a13db377-54c8-46f0-9b4b-3d5f648d24b8'},
            {'base_path': '/guidance/get-help-to-recruit-board-members-for-large-or-growing-mats',
             'content_id': '5f483219-ad3e-48ec-afbb-4b0caca34b35'},
            {'base_path': '/guidance/get-leadership-development-for-teachers-from-under-represented-groups',
             'content_id': '2ef312e5-f81f-4b72-ab01-1c3ebc057e2b'},
            {'base_path': '/guidance/accelerate-the-development-of-nqts-and-early-career-teachers',
             'content_id': '7a66415e-a6bf-41d6-911e-bb73daf3eea8'},
            {'base_path': '/guidance/access-museum-activities-to-improve-cultural-engagement',
             'content_id': '9d72a460-792a-4c7d-a3e6-4dc99663e382'},
            {'base_path': '/guidance/join-the-maths-teaching-for-mastery-programme',
             'content_id': '4bddfc81-4e26-4e01-b9e4-8c122857a0c0'},
            {'base_path': '/guidance/access-funding-for-continuing-professional-development-in-science',
             'content_id': '69aa8285-6602-40f6-9946-7f98fbbe6d96'},
            {'base_path': '/guidance/school-governors-professional-development',
             'content_id': '5f141e49-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/guidance/women-leading-in-education-regional-networks',
             'content_id': '3bfb4087-08e4-4d8a-8043-63afb264e113'},
            {'base_path': '/guidance/get-school-led-support-to-use-evidence-to-improve-teaching-practice',
             'content_id': '9d6f90a5-8979-44a6-ab0e-d77df20bde14'},
            {'base_path': '/guidance/develop-skills-in-holocaust-education',
             'content_id': '66018302-5996-4352-89b5-60d217a22b5c'},
            {'base_path': '/guidance/get-help-to-increase-participation-in-advanced-maths',
             'content_id': '18d9a126-46f0-47f5-825a-02f4c9d7e062'},
            {'base_path': '/guidance/develop-the-critical-use-of-evidence-in-geography-and-science',
             'content_id': 'ca8bb356-6bdd-4106-96f8-51a695431cc4'},
            {'base_path': '/guidance/join-the-teaching-leaders-programme-to-develop-future-leaders',
             'content_id': '3363fdf6-5afd-47d0-8725-533d44153851'},
            {'base_path': '/guidance/take-part-in-practical-training-to-improve-pupil-behaviour',
             'content_id': 'ac6af584-492e-4e29-b3d9-a6bd37409b18'},
            {'base_path': '/guidance/send-students-on-the-lessons-from-auschwitz-course',
             'content_id': '5855867b-b13f-4a72-a4a6-158b4c0e9736'},
            {'base_path': '/guidance/16-to-19-funding-advanced-maths-premium',
             'content_id': '30a633ab-6d31-4505-a0c6-5781d235803a'},
            {'base_path': '/guidance/join-the-future-leaders-programme-to-help-you-progress-to-headship',
             'content_id': 'd48541ea-02d7-46a2-9071-7ee5447a2cd6'},
            {'base_path': '/guidance/reducing-workload-in-your-school',
             'content_id': '8276dfe3-ccb0-4751-a92b-ec3ac362ca56'},
            {'base_path': '/guidance/get-support-to-increase-the-take-up-of-a-level-physics',
             'content_id': '9af7a450-90c4-44d7-b971-0e4677affebe'},
            {'base_path': '/guidance/national-professional-qualification-for-middle-leadership-npqml',
             'content_id': '5f109f8d-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/guidance/help-gcse-and-a-level-students-transition-to-higher-level-physics',
             'content_id': '0334453a-5f9e-43f5-a62f-e14ce509e42c'},
            {'base_path': '/guidance/national-professional-qualification-for-senior-leadership-npqsl',
             'content_id': '5f1210c1-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/guidance/national-professional-qualification-for-headship-npqh',
             'content_id': '5f106bd1-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/guidance/national-professional-qualification-for-executive-leadership-npqel',
             'content_id': 'f0186e1e-85a4-4773-86f1-77fa5a42e067'},
            {'base_path': '/guidance/school-improvement-support-for-the-2018-to-2019-academic-year',
             'content_id': '9294f0f0-4d9b-4fc9-9381-4b7e71d5ce03'}]},
          'content_id': '15de6921-4af2-4428-ae57-48dd87dcc9d2'},
         {'_id': '/government/collections/monitors-board-and-committee-papers',
          'expanded_links': {'documents': [{'base_path': '/government/publications/monitors-rules-of-procedure',
             'content_id': '5f187548-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/monitor-board-papers-for-28-april-2014-meeting',
             'content_id': '5f57ee62-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/monitor-audit-and-risk-committee-papers-february-2014',
             'content_id': '5f4c584d-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/monitor-audit-and-risk-committee-papers-november-2013',
             'content_id': '5f57a7a8-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/monitor-board-papers-for-17-december-2014-meeting',
             'content_id': '10b4735f-72f7-48f7-ae01-12ab7b6178ce'},
            {'base_path': '/government/publications/monitor-board-papers-for-26-march-2014-meeting',
             'content_id': '5f4c57b6-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/monitor-audit-and-risk-committee-papers-september-2013',
             'content_id': '5f57a731-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/monitor-board-papers-for-26-november-2014-meeting',
             'content_id': '60549319-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/monitor-board-papers-for-26-february-2014-meeting',
             'content_id': '5f4c65cf-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/monitor-remuneration-committee-papers-october-2014',
             'content_id': 'd569ef4b-d632-49a0-9795-6a7ea934b799'},
            {'base_path': '/government/publications/monitor-board-papers-for-29-october-2014-meeting',
             'content_id': '6027c34d-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/monitor-board-papers-for-29-january-2014-meeting',
             'content_id': '5f4c7e4f-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/monitor-remuneration-committee-papers-march-2014',
             'content_id': '5f57c43a-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/monitor-board-papers-for-24-september-2014-meeting',
             'content_id': '601b37ea-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/monitor-audit-and-risk-committee-papers-november-2014',
             'content_id': 'b1f9cc4b-6549-48a9-a75f-9038ab518d36'},
            {'base_path': '/government/publications/monitor-remuneration-committee-papers-september-2013',
             'content_id': '5f57efdc-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/monitor-board-papers-for-30-july-2014-meeting',
             'content_id': '5fe0f756-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/monitor-audit-and-risk-committee-papers-september-2014',
             'content_id': '60567e7f-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/monitor-remuneration-committee-papers-july-2013',
             'content_id': '5f57f025-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/monitor-board-papers-for-25-june-2014-meeting',
             'content_id': '5f660123-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/monitor-audit-and-risk-committee-papers-july-2014',
             'content_id': '601d0eb9-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/monitor-nomination-committee-papers-october-2014',
             'content_id': 'd52d8203-10df-4ad2-9689-6b8ca5f67afc'},
            {'base_path': '/government/publications/monitor-board-papers-for-28-may-2014-meeting',
             'content_id': '5f5d9c3f-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/monitor-audit-and-risk-committee-papers-may-2014',
             'content_id': '5fe17596-7631-11e4-a3cb-005056011aef'}]},
          'content_id': '5f4c7b0f-7631-11e4-a3cb-005056011aef'},
         {'_id': '/government/collections/public-expenditure-statistical-analyses-pesa',
          'expanded_links': {'documents': [{'base_path': '/government/statistics/public-expenditure-statistical-analyses-2018',
             'content_id': '6a01e0be-196c-4b81-bfd7-32c0531d6cd8'},
            {'base_path': '/government/statistics/public-expenditure-statistical-analyses-2017',
             'content_id': '305c3a64-19e0-439a-8b88-f9d5baea74f7'},
            {'base_path': '/government/statistics/public-expenditure-statistical-analyses-2016',
             'content_id': '935b1ca0-6589-4836-a9d1-d4b461c5261c'},
            {'base_path': '/government/statistics/public-expenditure-statistical-analyses-2015',
             'content_id': 'd2bb19b7-3ac7-44f2-bf82-596e3e855736'},
            {'base_path': '/government/statistics/public-expenditure-statistical-analyses-2014',
             'content_id': '5fa9dcaf-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/statistics/public-expenditure-statistical-analyses-2013-update-for-2015-16',
             'content_id': '5eba21ed-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/statistics/public-expenditure-statistical-analyses-2013',
             'content_id': '5e5a8dee-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/statistics/public-expenditure-statistical-analyses-2012',
             'content_id': '5dffdf5b-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/statistics/public-expenditure-statistical-analyses-2011',
             'content_id': '5dffdf13-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/statistics/public-expenditure-statistical-analyses-2010',
             'content_id': '5dffdec8-7631-11e4-a3cb-005056011aef'}]},
          'content_id': '5eb7e1ad-7631-11e4-a3cb-005056011aef'},
         {'_id': '/government/collections/tax-avoidance-general-anti-abuse-rule-gaar',
          'expanded_links': {'documents': [{'base_path': '/government/publications/tax-avoidance-general-anti-abuse-rules',
             'content_id': '601ab98b-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/gaar-advisory-panel-opinion-of-25-january-2019-individuals-claiming-relief-for-film-related-losses-and-split-sale-of-interest-in-partnerships',
             'content_id': '481a0434-1c14-440a-b9da-a77271d36c34'},
            {'base_path': '/government/publications/compliance-checks-information-about-the-general-anti-abuse-rule-ccfs34a',
             'content_id': '53d401c1-0645-42fc-8edb-1084f9ee7296'},
            {'base_path': '/government/publications/tax-avoidance-previous-guidance-on-general-anti-abuse-rule',
             'content_id': '145a9711-5ebd-488e-b93e-e9a7c4a7c651'},
            {'base_path': '/government/publications/gaar-advisory-panel-opinion-employee-rewards-using-loans',
             'content_id': 'd2c6aaa6-ca1d-4087-a54d-e52905faa6df'},
            {'base_path': '/government/publications/general-anti-abuse-rule-and-pooling-notices-ccfs35',
             'content_id': 'f21c2563-84ef-49e5-a435-4e579d83ffae'},
            {'base_path': '/government/publications/gaar-advisory-panel-opinion-contractor-rewards-using-loans',
             'content_id': 'f9937fa1-f5ff-4488-969a-4ddd29dcb741'},
            {'base_path': '/government/publications/compliance-checks-provisional-counteraction-notices-given-under-the-gaar-ccfs36',
             'content_id': '58820c37-5698-4a0e-a758-06bbb75f37ed'},
            {'base_path': '/government/publications/gaar-advisory-panel-opinion-of-25-june-2018-employee-rewards-using-deeds-of-contribution-employee-loan-and-tripartite-agreements',
             'content_id': '86434d80-a5b5-4778-a8d6-16302688a778'},
            {'base_path': '/government/publications/compliance-checks-general-anti-abuse-rule-and-notices-of-binding-ccfs37',
             'content_id': 'e7b79522-10f3-4cd1-8593-22c9cfbbe14d'},
            {'base_path': '/government/publications/gaar-advisory-panel-opinion-of-28-february-2018-employee-rewards-using-multiple-deeds-and-tripartite-agreements',
             'content_id': '5bb733f3-c7d0-4582-9e79-5a952cadb2d3'},
            {'base_path': '/government/publications/gaar-advisory-panel-opinion-of-26-january-2018-employee-rewards-using-multiple-tripartite-arrangements',
             'content_id': '34c7384c-49c8-4bd2-b0ca-6bd797c493a2'},
            {'base_path': '/government/publications/gaar-advisory-panel-opinion-of-17-november-2017-extraction-of-cash-or-equivalent-through-trust-interests',
             'content_id': 'ba48cf29-a3fe-4acb-a613-7a6aa1dc2b58'},
            {'base_path': '/government/publications/gaar-advisory-panel-opinion-of-10-november-2017-employee-rewards-using-gold-bullion',
             'content_id': '0073a4ad-2507-418e-9508-e07131b64ce9'},
            {'base_path': '/government/publications/gaar-advisory-panel-opinion-of-9-november-2017-employee-rewards-using-gold-bullion',
             'content_id': '049672d3-af3f-4bdf-943e-cb5c8556926f'},
            {'base_path': '/government/publications/gaar-advisory-panel-opinion-employee-rewards-using-gold-bullion',
             'content_id': 'cd6b0eea-f533-4fb4-9d5f-615561b875fb'}]},
          'content_id': '8f7a618d-ee2a-48a0-bb82-ea3bd34880da'},
         {'_id': '/government/collections/prior-qualifications-of-adult-learners',
          'expanded_links': {'documents': [{'base_path': '/government/publications/prior-qualifications-of-adult-apprentices-2011-to-2012',
             'content_id': '5ebe91a6-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/prior-qualifications-of-adults-on-skills-for-life-courses-2010-to-2011',
             'content_id': '5ebe9248-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/prior-qualifications-of-adults-in-further-education-classroom-based-courses-2011-to-2012',
             'content_id': '5ebe8d86-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/prior-qualifications-of-adults-in-further-education-workplace-learning-2011-to-2012',
             'content_id': '5ebe91f7-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/prior-qualifications-of-adult-apprentices-2010-to-2011',
             'content_id': '5c9be5ea-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/prior-qualifications-of-learners-on-train-to-gain-provision-at-level-2-and-level-3-in-2010-to-2011',
             'content_id': '5c9be695-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/prior-qualifications-of-adults-undertaking-classroom-based-courses-in-further-education-2010-to-2011',
             'content_id': '5c9be638-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/prior-qualifications-of-adult-learners-adult-apprentices-2009-to-2010',
             'content_id': '5c995a79-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/prior-qualifications-of-adult-learners-train-to-gain-2009-to-2010',
             'content_id': '5c995aca-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/prior-qualifications-of-adult-learners-learner-responsive-provision-2009-to-2010',
             'content_id': '5c995b18-7631-11e4-a3cb-005056011aef'}]},
          'content_id': '5ec3131e-7631-11e4-a3cb-005056011aef'},
         {'_id': '/government/collections/catch-quota-trials-reports',
          'expanded_links': {'documents': [{'base_path': '/government/publications/catch-quota-trials-north-sea-cod-2013-final-report',
             'content_id': '5fe5a55e-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/catch-quota-trials-western-haddock-2013-interim-report',
             'content_id': '5f58d30a-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/north-sea-cod-catch-quota-trials-final-report-2015',
             'content_id': '9eb48f4f-96d9-4bf3-a3ee-2af9d6ba1df1'},
            {'base_path': '/government/publications/catch-quota-trials-north-sea-cod-2013-interim-report',
             'content_id': '5f58cec0-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/catch-quota-trials-western-haddock-final-report-2014',
             'content_id': 'b2851f6b-8d17-49c1-80e6-a16239e83a58'},
            {'base_path': '/government/publications/catch-quota-trials-2012-final-report',
             'content_id': '5f58cc25-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/north-sea-cod-catch-quota-trials-final-report-2014',
             'content_id': 'd6655a86-7af9-4479-9476-7dd19be2e1da'},
            {'base_path': '/government/publications/catch-quota-trials-under-10-metre-trial',
             'content_id': '5f58ce2b-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/catch-quota-trials-south-west-beam-trawl-2013-final-report',
             'content_id': '9293591e-61cb-4e06-a65a-7722a70ac43a'},
            {'base_path': '/government/publications/catch-quota-trials-2012-interim-report',
             'content_id': '5f58cb90-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/catch-quota-trial-final-report-2013-western-haddock',
             'content_id': '601bd61d-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/catch-quota-trials-2011-final-report',
             'content_id': '5f58a703-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/grade-composition-and-selectivity-of-haddock-in-ices-vii-b-k',
             'content_id': '5ff12ba1-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/catch-quota-trials-2011-interim-report',
             'content_id': '5f58a3a1-7631-11e4-a3cb-005056011aef'}]},
          'content_id': '5f58d8c7-7631-11e4-a3cb-005056011aef'},
         {'_id': '/government/collections/administrative-court-forms',
          'expanded_links': {'documents': [{'base_path': '/government/publications/form-exn162-respondents-notice-to-an-application-for-permission-to-appeal-under-sections-26-28-103-105-108-and-110-of-the-extradition-act-2003',
             'content_id': '0b69ddbe-fbc5-45db-ab15-15dacda07b89'},
            {'base_path': '/government/publications/form-n154-notice-of-allocation-to-the-fast-track',
             'content_id': '113ca76c-6ece-4749-8b01-dca60c4890a1'},
            {'base_path': '/government/publications/form-n155-notice-of-allocation-to-multi-track',
             'content_id': '6b7e6148-9fc9-41d0-a065-3ac42bd70fd5'},
            {'base_path': '/government/publications/form-n157-notice-of-allocation-to-the-small-claims-track-hearing',
             'content_id': '30cbd32a-7ed7-4673-a017-e32ff3213631'},
            {'base_path': '/government/publications/form-n159-notice-of-allocation-to-the-small-claims-track-no-hearing',
             'content_id': '35a3a052-48d4-42ed-adf5-9852c63008e4'},
            {'base_path': '/government/publications/ask-for-a-hearing-to-be-adjourned-birmingham-form-ac001',
             'content_id': 'e6467a51-a2e1-40ea-8dba-03e60b9365db'},
            {'base_path': '/government/publications/form-n172-notice-of-trial-date',
             'content_id': 'b39eb5e0-6c6c-4997-aca4-759e780b6f78'},
            {'base_path': '/government/publications/ask-for-a-hearing-to-be-adjourned-cardiff-form-ac001',
             'content_id': '19cbf3cd-2505-41e9-b058-43cc34a3efac'},
            {'base_path': '/government/publications/form-n208-claim-form-cpr-part-8',
             'content_id': '6a3922f9-adbf-4753-9c6b-6beb636b1b26'},
            {'base_path': '/government/publications/ask-for-a-hearing-to-be-adjourned-leeds-form-ac001',
             'content_id': 'aa5609ab-d4e2-4192-8853-4058908e25b2'},
            {'base_path': '/government/publications/form-n279-notice-of-discontinuance',
             'content_id': '7cef3017-6563-4af7-bc33-634c48d92f5d'},
            {'base_path': '/government/publications/ask-for-a-hearing-to-be-adjourned-london-form-ac001',
             'content_id': 'c08784c0-d3dc-417e-9134-e7bb76a688e0'},
            {'base_path': '/government/publications/form-n434-notice-of-change-of-solicitor',
             'content_id': '2ecee877-ae47-4933-8f79-d02754a4dca1'},
            {'base_path': '/government/publications/ask-for-a-hearing-to-be-adjourned-manchester-form-ac001',
             'content_id': 'a3635e54-649b-4f07-a417-ef4d8aafcaf6'},
            {'base_path': '/government/publications/form-n461-judicial-review-claim-form-administrative-court',
             'content_id': '4bbb4b23-8ab9-41a2-80f6-93e0756a981b'},
            {'base_path': '/government/publications/form-ac010-notice-of-appeal-to-the-high-court-modificationrenewal-of-non-derogating-control-orders',
             'content_id': '6cdf2b0d-82ef-4052-b542-2315b39a8277'},
            {'base_path': '/government/publications/form-n462-judicial-review-acknowledgment-of-service',
             'content_id': '25f1c346-a6d2-4c03-be40-184962cd1b82'},
            {'base_path': '/government/publications/form-ac011-claim-form-under-section-11',
             'content_id': '469fc0c3-2e53-4f17-bfe1-6d0b636db6c6'},
            {'base_path': '/government/publications/form-n463-judicial-review-application-for-urgent-consideration',
             'content_id': '3ac4964a-a04c-4ae0-b9dd-786766b87b45'},
            {'base_path': '/government/publications/form-ac014-skeleton-argument-template',
             'content_id': 'e29ead66-415b-4e2e-8ce3-e957d049d1e0'},
            {'base_path': '/government/publications/form-n464-application-for-directions-as-to-venue-for-administration-and-determination',
             'content_id': 'a3e18f73-109a-43f6-a79f-99f4973264db'},
            {'base_path': '/government/publications/form-control-order-claim-form-under-section-11',
             'content_id': '8136d2e5-c12c-434f-afe4-9c72d69bbbe6'},
            {'base_path': '/government/publications/form-n465-response-to-application-as-to-venue-for-administration-and-determination',
             'content_id': '3cfc70c7-d99b-47d2-b6e3-a49f07d18dc2'},
            {'base_path': '/government/publications/form-ex244-application-notice-pursuant-to-the-extradition-act-2003',
             'content_id': 'dc81db6a-eec8-4317-9f50-0aa3dfc1b5f2'},
            {'base_path': '/government/publications/form-pf244-application-notice-part-23-in-the-high-court-of-justice-queens-bench-division-administrative-court-list',
             'content_id': '8da5f598-6e21-4f98-9688-17280ab6a909'},
            {'base_path': '/government/publications/form-exn161-appellants-notice-application-for-permission-to-appeal-under-sections-26-28-103-105-108-and-110-of-the-extradition-act-2003',
             'content_id': '9c721cfd-59e4-4022-a564-4b68b5570acb'}]},
          'content_id': '863186d6-1e04-4e15-b906-63acdbc0c9bb'},
         {'_id': '/government/collections/police-and-crime-newletter',
          'expanded_links': {'documents': [{'base_path': '/government/publications/crime-policing-and-fire-news-update-february-2017',
             'content_id': '15933673-c3d5-44aa-b281-560c7347f540'},
            {'base_path': '/government/publications/crime-policing-and-fire-news-update-december-2016',
             'content_id': 'e9cc3f1c-71ff-469a-b27d-98f4bca036cc'},
            {'base_path': '/government/publications/crime-and-policing-news-update-january-2015',
             'content_id': 'a485cb1d-c9ea-40df-abd9-8be819d23119'},
            {'base_path': '/government/publications/crime-and-policing-news-update-january-2014',
             'content_id': '5efca82b-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/crime-and-policing-newsletter-march-2013',
             'content_id': '5e00fbb4-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/crime-policing-and-fire-news-update-may-2016',
             'content_id': '56aee527-c3a5-4f59-ac69-e6f59de146c6'},
            {'base_path': '/government/publications/crime-and-policing-news-update-february-2015',
             'content_id': 'b61607fc-9419-4fb8-9bae-712f38ea1c23'},
            {'base_path': '/government/publications/crime-and-policing-news-update-february-2014',
             'content_id': '5f19169c-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/crime-and-policing-newsletter-january-2013',
             'content_id': '5e2b3d30-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/crime-and-policing-news-update-december-2012',
             'content_id': '5e2a3fb7-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/crime-and-policing-news-update-march-2016',
             'content_id': 'f83db2b9-7d08-42ca-ba73-6ed81ab55e60'},
            {'base_path': '/government/publications/crime-and-policing-news-update-march-2015',
             'content_id': '58539aa7-7776-4c1f-b995-bd9e3f7187e4'},
            {'base_path': '/government/publications/crime-and-policing-news-update-march-2014',
             'content_id': '5f48d47f-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/crime-and-policing-newsletter-february-2013',
             'content_id': '5e2d6780-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/crime-and-policing-news-update-february-2016',
             'content_id': '1e1da6a4-008c-4c3f-9993-93b09ecb5531'},
            {'base_path': '/government/publications/crime-and-policing-news-update-may-2015',
             'content_id': '6704fa90-852f-4928-a736-0c8ef0400998'},
            {'base_path': '/government/publications/crime-and-policing-news-update-april-2014',
             'content_id': '5f515699-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/crime-and-policing-newsletter-may-2013',
             'content_id': '5e31f5bc-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/crime-and-policing-news-update-january-2016',
             'content_id': 'a6a0b7c6-78d4-4355-acdb-c671d1171d7c'},
            {'base_path': '/government/publications/crime-and-policing-news-update-june-2015',
             'content_id': '67d26660-c28a-461f-806c-8c255a5d5054'},
            {'base_path': '/government/publications/crime-and-policing-news-update-may-2014',
             'content_id': '5f5e252f-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/crime-and-policing-news-update-june-2013',
             'content_id': '5e373074-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/crime-and-policing-news-update-july-2015',
             'content_id': '00b8350f-1865-46ea-a9f6-983904fdefad'},
            {'base_path': '/government/publications/crime-and-policing-news-update-june-2014',
             'content_id': '5f66fcff-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/crime-and-policing-news-update-july-2013',
             'content_id': '5e5c7992-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/crime-and-policing-news-update-august-2015',
             'content_id': '0e1feca2-3315-4622-a2b6-cb0915786d1a'},
            {'base_path': '/government/publications/crime-and-policing-news-update-july-2014',
             'content_id': '5fe255b9-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/crime-and-policing-news-update-august-2013',
             'content_id': '5e8c4bda-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/crime-and-policing-news-update-september-2015',
             'content_id': '7a40f342-6c44-422f-8f31-d6371972d95f'},
            {'base_path': '/government/publications/crime-and-policing-news-update-august-2014',
             'content_id': '5febd387-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/crime-and-policing-news-update-september-2013',
             'content_id': '5e962007-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/crime-and-policing-news-update-october-2015',
             'content_id': 'd8feab0e-fea5-40c9-9dee-9c231ca809f9'},
            {'base_path': '/government/publications/crime-and-policing-news-update-september-2014',
             'content_id': '601d1124-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/crime-and-policing-news-update-october-2013',
             'content_id': '5ebd1d54-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/crime-and-policing-news-updates-november-2015',
             'content_id': '4fa106f2-ea64-4651-88f8-dd04c606e45d'},
            {'base_path': '/government/publications/crime-and-policing-news-update-october-2014',
             'content_id': '6029cb84-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/crime-and-policing-news-update-november-2013',
             'content_id': '5ee5bb27-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/crime-and-policing-news-update-december-2015',
             'content_id': '3ddc9150-7871-4b82-99d3-ad65c8cc084c'},
            {'base_path': '/government/publications/crime-and-policing-news-update-november-2014',
             'content_id': '2fd6a764-ff5f-49ec-8554-5e91f1f7fa60'},
            {'base_path': '/government/publications/crime-and-policing-news-update-december-2013',
             'content_id': '5ef4e026-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/crime-and-policing-news-update-december-2014',
             'content_id': '5e7c7a3f-0893-41f1-9bca-61cc13478a0c'}]},
          'content_id': '5eb722d8-7631-11e4-a3cb-005056011aef'},
         {'_id': '/government/collections/uk-trade-investment-ukti-research',
          'expanded_links': {'documents': [{'base_path': '/government/publications/investigation-into-links-between-internationalisation-and-firm-performance',
             'content_id': '601d091e-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/uktis-internationalisation-strategies-barriers-and-awareness-survey-2014',
             'content_id': '601bb990-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/the-costs-to-the-uk-of-language-deficiencies-as-a-barrier-to-uk-engagement-in-exporting',
             'content_id': '5f57333f-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/technical-note-uktis-monitoring-and-evaluation-evidence',
             'content_id': '5f5f97b1-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/ukti-pims-non-user-survey-2014',
             'content_id': '74548514-89d1-441e-8fe4-a0b10470ea56'},
            {'base_path': '/government/publications/an-assessment-of-open-to-export',
             'content_id': 'cbaf4bad-4e60-4b21-a810-440ca2134a21'},
            {'base_path': '/government/publications/evaluation-of-the-impact-and-cost-effectiveness-of-uktis-support-for-events',
             'content_id': '568f77d3-990b-4715-bf35-0d0645e1ef4f'},
            {'base_path': '/government/publications/investigation-into-the-extensive-and-intensive-margins-of-growth-in-the-value-of-uk-exports-and-the-role-of-sme-exporters',
             'content_id': '5f347020-dad2-47a4-b73d-618574720103'},
            {'base_path': '/government/publications/the-impact-of-ukti-trade-services-on-value-of-goods-exported-by-supported-firms',
             'content_id': '40d15ab0-5338-491f-baf2-7d42190ce5ed'},
            {'base_path': '/government/publications/evaluating-the-impact-of-ukti-trade-services-on-the-performance-of-supported-firms',
             'content_id': '9946f7f5-065b-4c2a-8639-6ef90fee7461'}]},
          'content_id': '5f572e53-7631-11e4-a3cb-005056011aef'},
         {'_id': '/government/collections/senior-staff-business-expenses--2',
          'expanded_links': {'documents': [{'base_path': '/government/publications/nio-senior-staff-business-expenses-january-march-2013',
             'content_id': '5e5c5688-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/nio-board-information-release-1-october-31-december-2012',
             'content_id': '5e2f9cc9-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/nio-senior-staff-business-expenses-october-to-december-2012',
             'content_id': '5d65743e-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/nio-senior-staff-organisational-chart',
             'content_id': '5e371b2e-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/nio-senior-staff-business-expenses-april-to-june-2012',
             'content_id': '5d658148-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/nio-senior-staff-business-expenses-july-to-september-2012',
             'content_id': '5db8f4db-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/nio-senior-staff-business-expenses-october-to-december-2011',
             'content_id': '5d65842f-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/nio-director-general-external-meetings-july-to-september-2011',
             'content_id': '5d658978-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/nio-senior-staff-business-expenses-july-to-september-2011',
             'content_id': '5d658a19-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/nio-director-general-external-meetings-april-to-june-2011',
             'content_id': '5d6591f6-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/nio-senior-staff-business-expenses-april-to-june-2011--2',
             'content_id': '5d659401-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/nio-senior-staff-business-expenses-january-to-march-2011',
             'content_id': '5d659a75-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/nio-director-general-external-meetings-january-to-march-2011',
             'content_id': '5d659ac1-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/nio-senior-staff-business-expenses-oct-to-dec-2010',
             'content_id': '5d65a38f-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/appointments-of-sheriffs-for-northern-ireland-for-2011',
             'content_id': '5d65a5ce-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/nio-senior-staff-business-expenses-july-to-sept-2010',
             'content_id': '5d65c324-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/nio-senior-staff-business-expenses-april-to-june-2010',
             'content_id': '5d65ca8b-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/nio-senior-staff-business-expenses-jan-to-march-2010',
             'content_id': '5d65cda0-7631-11e4-a3cb-005056011aef'}]},
          'content_id': '5eb7113e-7631-11e4-a3cb-005056011aef'},
         {'_id': '/government/collections/bis-government-procurement-card-spend-over-500',
          'expanded_links': {'documents': [{'base_path': '/government/publications/bis-spending-over-500-on-a-gpc-for-july-2016',
             'content_id': 'bbf1ac10-e95a-44f8-ac6c-bef929bc1651'},
            {'base_path': '/government/publications/bis-spending-over-500-on-a-gpc-for-december-2015',
             'content_id': '62093dd2-75d5-406c-bd6a-6d9a6da5abf0'},
            {'base_path': '/government/publications/bis-spending-over-500-on-a-gpc-for-december-2014',
             'content_id': '99ab7c6a-4e8f-48e9-a880-90a221350e00'},
            {'base_path': '/government/publications/bis-government-procurement-card-spend-over-500-december-2013',
             'content_id': '5f53ff45-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/bis-government-procurement-card-spend-over-500-december-2012',
             'content_id': '5d8f2005-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/bis-government-procurement-card-spend-over-500-october-to-december-2011',
             'content_id': '5c8385d6-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/bis-spending-over-500-on-a-gpc-for-june-2016',
             'content_id': '3102c73c-9baa-46af-9896-6843e6a4f91c'},
            {'base_path': '/government/publications/bis-spending-over-500-on-a-gpc-for-november-2015',
             'content_id': '3143aa5e-fb48-456b-90a3-694bf04a2c34'},
            {'base_path': '/government/publications/bis-spending-over-500-on-a-gpc-for-november-2014',
             'content_id': '1b85e77c-f1bf-4c16-8b0c-a255dfb39ee7'},
            {'base_path': '/government/publications/bis-government-procurement-card-spend-over-500-november-2013',
             'content_id': '5f53fef9-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/bis-government-procurement-card-spend-over-500-november-2012',
             'content_id': '5d38f8da-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/bis-government-procurement-card-spend-over-500-july-to-september-2011',
             'content_id': '5c838626-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/bis-spending-over-500-on-a-gpc-for-may-2016',
             'content_id': '0bbfda3a-e5bc-49ca-978e-99327b7e5517'},
            {'base_path': '/government/publications/bis-spending-over-500-on-a-gpc-for-october-2015',
             'content_id': 'efe3af04-d3cf-4f86-8783-ea38738c9385'},
            {'base_path': '/government/publications/bis-spending-over-500-on-a-gpc-for-october-2014',
             'content_id': '57bf1af4-7cd9-4074-bc44-c8ce5a9291a7'},
            {'base_path': '/government/publications/bis-government-procurement-card-spend-over-500-october-2013',
             'content_id': '5f53fe64-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/bis-government-procurement-card-spend-over-500-october-2012',
             'content_id': '5d293a1c-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/bis-government-procurement-card-spend-over-500-april-to-june-2011',
             'content_id': '5c838676-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/bis-spending-over-500-on-a-gpc-for-april-2016',
             'content_id': 'a6e079b6-6b7b-4ed4-90c6-7ec3bb6bd91d'},
            {'base_path': '/government/publications/bis-spending-over-500-on-a-gpc-for-september-2015',
             'content_id': 'e45f2842-aee6-43ee-aad9-0475fa24e314'},
            {'base_path': '/government/publications/bis-spending-over-500-on-a-gpc-for-september-2014',
             'content_id': 'ecb56c1b-7665-4b5a-9bd9-3ec146bec051'},
            {'base_path': '/government/publications/bis-government-procurement-card-spend-over-500-september-2013',
             'content_id': '5f53fe1b-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/bis-government-procurement-card-spend-over-500-september-2012',
             'content_id': '5d293906-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/bis-spending-over-500-on-a-gpc-for-march-2016',
             'content_id': 'bc752938-d601-4a23-9513-a099c6c8a9f5'},
            {'base_path': '/government/publications/bis-spending-over-500-on-a-gpc-for-august-2015',
             'content_id': 'b8e2a3e5-2ec2-45f5-a0df-05ed85436022'},
            {'base_path': '/government/publications/bis-spending-over-500-on-a-gpc-for-august-2014',
             'content_id': '1717ad3f-59c9-41b5-9c45-60f732e608e7'},
            {'base_path': '/government/publications/bis-government-procurement-card-spend-over-500-august-2013',
             'content_id': '5ef565d1-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/bis-government-procurement-card-spend-over-500-august-2012',
             'content_id': '5c836861-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/bis-spending-over-500-on-a-gpc-for-february-2016',
             'content_id': '20f3fd31-9477-4407-8244-73aa8f910a96'},
            {'base_path': '/government/publications/bis-spending-over-500-on-a-gpc-for-july-2015',
             'content_id': '8bc2083f-74a4-4da8-8b6e-8b55ae5b4291'},
            {'base_path': '/government/publications/bis-spending-over-500-on-a-gpc-for-july-2014',
             'content_id': '90605c24-ad1a-4f99-b82c-5f73c40ff7e8'},
            {'base_path': '/government/publications/bis-government-procurement-card-spend-over-500-july-2013',
             'content_id': '5ec45733-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/bis-government-procurement-card-spend-over-500-july-2012',
             'content_id': '5c8384de-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/bis-spending-over-500-on-a-gpc-for-january-2016',
             'content_id': 'bded7341-a2f5-4f54-b31c-0521cc535140'},
            {'base_path': '/government/publications/bis-spending-over-500-on-a-gpc-for-june-2015',
             'content_id': '3413661f-2915-4743-b51a-e8e465e10f96'},
            {'base_path': '/government/publications/bis-spending-over-500-on-a-gpc-for-june-2014',
             'content_id': '58eddfff-e972-48ee-9be0-679f27fc2928'},
            {'base_path': '/government/publications/bis-government-procurement-card-spend-over-500-june-2013',
             'content_id': '5e9cbde8-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/bis-government-procurement-card-spend-over-500-april-to-june-2012',
             'content_id': '5c83852e-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/bis-spending-over-500-on-a-gpc-for-may-2015',
             'content_id': '11a7661d-db6b-4ff7-beb6-9b252f3192fe'},
            {'base_path': '/government/publications/bis-spending-over-500-on-a-gpc-for-may-2014',
             'content_id': '5ff0e8ce-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/statistics/bis-government-procurement-card-spend-over-500-may-2013',
             'content_id': '5e953a31-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/bis-government-procurement-card-spend-over-500-january-to-march-2012',
             'content_id': '5c83857b-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/bis-spending-over-500-on-a-gpc-for-april-2015',
             'content_id': 'e1097293-45ff-4702-8ab5-40b2303679ea'},
            {'base_path': '/government/publications/bis-government-procurement-card-spend-over-500-april-2014',
             'content_id': '5fed5f33-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/bis-government-procurement-card-spend-over-500-april-2013',
             'content_id': '5e8df8a7-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/bis-spending-over-500-on-a-gpc-for-march-2015',
             'content_id': '2cfda37f-aac6-443c-a236-fd9f236a6f49'},
            {'base_path': '/government/publications/bis-government-procurement-card-spend-over-500-march-2014',
             'content_id': '5fa76f58-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/bis-government-procurement-card-spend-over-500-march-2013',
             'content_id': '5e382e47-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/bis-spending-over-500-on-a-gpc-for-february-2015',
             'content_id': 'ce902e2c-628f-4db5-b722-b9538e161b1d'},
            {'base_path': '/government/publications/bis-government-procurement-card-spend-over-500-february-2014',
             'content_id': '5fa6c2f1-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/bis-government-procurement-card-spend-over-500-february-2013',
             'content_id': '5e2de6dc-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/bis-spending-over-500-on-a-gpc-for-january-2015',
             'content_id': '5d40a265-721e-4873-ab8e-fa3cfa093b7c'},
            {'base_path': '/government/publications/bis-government-procurement-card-spend-over-500-january-2014',
             'content_id': '5f65c52b-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/bis-government-procurement-card-spend-over-500-january-2013',
             'content_id': '5e2b4182-7631-11e4-a3cb-005056011aef'}]},
          'content_id': '5eb63bdd-7631-11e4-a3cb-005056011aef'},
         {'_id': '/government/collections/manage-your-fishing-effort',
          'expanded_links': {'documents': [{'base_path': '/government/publications/manage-your-fishing-effort-cod-recovery-zone',
             'content_id': '5f8f14e6-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/guidance/manage-your-fishing-effort-western-waters-crabs',
             'content_id': '5f5ccf1f-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/manage-your-fishing-effort-sole-recovery-zone',
             'content_id': '5f8f2719-7631-11e4-a3cb-005056011aef'}]},
          'content_id': '5f5cd007-7631-11e4-a3cb-005056011aef'},
         {'_id': '/government/collections/sccog-probation-documents-2006-to-2014',
          'expanded_links': {'documents': [{'base_path': '/government/publications/sccog-national-agreement-on-pay-and-conditions-of-service',
             'content_id': '02463250-56b0-42c2-8318-f64d7e49d89d'},
            {'base_path': '/government/publications/sccog-circulars-2014',
             'content_id': '95195641-fa21-4810-a9c5-3f0bc4062c76'},
            {'base_path': '/government/publications/sccog-circulars-2013',
             'content_id': '2d55a076-8b21-4426-8f66-354599daead0'},
            {'base_path': '/government/publications/sccog-circulars-2012',
             'content_id': '9b4acc35-439d-40f0-871e-4f48fb8288e5'},
            {'base_path': '/government/publications/sccog-circulars-2011',
             'content_id': '731bb762-2f64-45aa-88fb-0b1eefb53214'},
            {'base_path': '/government/publications/sccog-circulars-2010',
             'content_id': '4b4d5145-b9b6-481d-9f6d-01a2ddd78c03'},
            {'base_path': '/government/publications/sccog-circulars-2009',
             'content_id': 'a4a7d620-fcda-4834-960d-0bd03d32802e'},
            {'base_path': '/government/publications/sccog-circulars-2008',
             'content_id': 'e064edff-714e-4589-8d48-1b480dd00878'},
            {'base_path': '/government/publications/sccog-circulars-2007',
             'content_id': 'ecf624a5-d035-4f57-bf14-c948dbeb3a9f'},
            {'base_path': '/government/publications/sccog-circulars-2006',
             'content_id': 'fb0b0fc4-a7b6-417c-ba2a-36c12ee61f69'}]},
          'content_id': '4414c6ef-d68c-4db2-9538-aac7518b2e6c'},
         {'_id': '/government/collections/asset-purchase-facility',
          'expanded_links': {'documents': [{'base_path': '/government/publications/asset-purchase-facility-apf-ceiling-november-2017',
             'content_id': '3c56beb5-ad49-4e91-98f4-30891d439ac6'},
            {'base_path': '/government/publications/asset-purchase-facility-apf-ceiling-august-2017',
             'content_id': 'c790e1e8-e9f2-404e-93cc-2fa1b122dc60'},
            {'base_path': '/government/publications/asset-purchase-facility-apf-ceiling-august-2016',
             'content_id': '4ea0e856-edff-4433-b4f7-f50fbc4edefd'},
            {'base_path': '/government/publications/asset-purchase-facility-cash-management-operations',
             'content_id': '5e122560-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/asset-purchase-facility-apf-ceiling-july-2012',
             'content_id': '5e1225aa-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/asset-purchase-facility-apf-ceiling-february-2012',
             'content_id': '5e12276a-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/asset-purchase-facility-apf-ceiling-november-2011',
             'content_id': '5e1227c1-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/asset-purchase-facility-apf-ceiling-october-2011',
             'content_id': '5e122808-7631-11e4-a3cb-005056011aef'}]},
          'content_id': '5eb7c7b2-7631-11e4-a3cb-005056011aef'},
         {'_id': '/government/collections/free-school-applications-assessing-the-need-for-school-places',
          'expanded_links': {'documents': [{'base_path': '/government/publications/free-school-applications-assessing-the-need-for-more-schools',
             'content_id': 'bab3f303-1e7c-4aa3-bb84-8230d1ef4ad6'},
            {'base_path': '/government/publications/mainstream-free-schools-assessing-the-need-for-a-new-school',
             'content_id': '934603e9-3ed4-4e47-bd0a-78be552ad180'},
            {'base_path': '/government/publications/free-schools-data-used-to-determine-their-location',
             'content_id': '601f3618-7631-11e4-a3cb-005056011aef'},
            {'base_path': '/government/publications/free-schools-opened-in-areas-needing-additional-school-places',
             'content_id': '5f646357-7631-11e4-a3cb-005056011aef'}]},
          'content_id': '86ee00c3-9714-45cd-af4c-4c5a5391b656'}], key=lambda k: k['_id'])



@pytest.mark.filterwarnings(
    "ignore:insert is deprecated. Use insert_one or insert_many instead.:DeprecationWarning")
@pytest.mark.filterwarnings(
    "ignore:collection_names is deprecated. Use list_collection_names instead.:UserWarning")
def test_get_all_links_df(mongodb):
    # print(get_all_links_df(mongodb.content_store_data_sample).head())
    pd_testing.assert_frame_equal(
        get_all_links_df(mongodb.content_store_data_sample).sort_values(),
        pd.read_csv('tests/unit/fixtures/all_links.csv'))
